define(["jquery","register/port"],function(a,b){function c(c){a.post(b.switchAuth,c,function(b){if("object"!=typeof b)try{b=a.parseJSON(b)}catch(c){return void alert("服务器数据异常，稍后再试")}if("true"==b.success){alert("短信已经发送，请注意接收验证码"),f.attr("disabled","disabled");var d=30,e=f.text(),g=setInterval(function(){f.text(d--+"秒后可再发送"),1>d&&(f.text(e).removeAttr("disabled"),clearInterval(g))},1e3)}else!b.success&&b.errMsg&&alert(b.errMsg)})}function d(b){a(".u-error-tip").hide();var c=h.find(".u-error-tip"),d=g.find(".u-error-tip"),e=i.find(".u-error-tip"),f=k.find(".u-error-tip"),l=j.find(".u-error-tip"),m=/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/,n=/^[a-z0-9A-Z]+$/,o=/^[\d]{11}$/,p=/^[\w]{6,20}$/;return console.log(b.user_phone),o.test(b.user_phone)?(d.hide(),m.test(b.user_email)?(l.hide(),p.test(b.user_psw)?(c.hide(),b.user_psw!=i.find("input").val()?(e.show(),!1):(e.hide(),n.test(b.user_auth)?(f.hide(),!0):(f.show(),!1))):(-c.show(),!1)):(l.show(),!1)):(d.show(),!1)}function e(c){a.ajax({url:b.register,type:"post",dataType:"json",data:c,success:function(b){if("object"!=typeof b)try{b=a.parseJSON(b)}catch(c){return void alert("服务器异常，稍后再试")}if("true"==b.success)b.nextSrc?location.href=b.nextSrc:alert("服务器异常，稍后再试");else if(b.no||b.no>=1&&b.no<=4)switch(b.no){case 1:showInputError(j,b.errMsg.inputMsg);break;case 2:showInputError($divUserPWd,b.errMsg.inputMsg);break;case 3:!function(){"mobile"==loginWay&&showInputError($divUserTel,b.errMsg.inputMsg)}();break;case 4:!function(){"normal"==loginWay?showInputError($divAuth1,b.errMsg.inputMsg):"mobile"==loginWay&&showInputError($divAuth2,b.errMsg.inputMsg)}()}else b.errMsg&&b.errMsg.otherMsg&&alert(b.errMsg.otherMsg)}})}var f=a(".sms-btn");f.on("click",function(){c({auth_way:"sms",timestemp:(new Date).getTime(),telNumber:a("#register-user-mobile").val()})}),a("#register-form input").on("focus",function(){a(".u-error-tip").hide()});var g=a("#register-user-mobile"),h=a("#user-pwd"),i=a("#user-re-pwd"),j=a("#register-user-email"),k=a("#register-user-auth");a("#register-form").on("submit",function(a){a.preventDefault();var b={user_phone:g.find("input").val(),user_psw:h.find("input").val(),user_email:j.find("input").val(),user_auth:k.find("input").val()};return d(b)?(e(b),!1):!1})});