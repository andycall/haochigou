define(["jquery","personal/port","jquery-ui"],function(a,b){console.log("order form loaded"),function(){var b=[];for(i=-24;25>i;i++)b[i]=0==i?1:5*i;var c=["正点","5分钟","10分钟","15分钟","20分钟","25分钟","30分钟","35分钟","40分钟","45分钟","50分钟","55分钟","1小时","1小时5分钟","1小时10分钟","1小时15分钟","1小时20分钟","1小时25分钟","1小时30分钟","1小时35分钟","1小时40分钟","1小时45分钟","1小时50分钟","1小时55分钟","2小时"];for(c[-24]="提前2小时",i=-23;-12>i;i++)c[i]="提前1小时"+5*(-i-12)+"分钟";for(c[-12]="提前1小时",i=-11;0>i;i++)c[i]="提前"+5*-i+"分钟";a(".slider").slider({range:"min",min:2,max:100,value:100,slide:function(b,d){var e=parseInt(a(this).attr("max")),f=parseInt(a(this).attr("min"));a(this).attr("rel"),a(this).slider("option","disabled",!1),a(this).slider("option","min",f),a(this).slider("option","max",e),a(this).slider("option","value",e),a(this).parents(".content").find(".col_value span").html(c[d.value-1]),a(this).parents(".content").find(".col_btn").css("display","block")}})}(),a.fn.serializeObject=function(){var b={},c=this.serializeArray();return a.each(c,function(){void 0!=b[this.name]?(b[this.name].push||(b[this.name]=[b[this.name]]),b[this.name].push(this.value||"")):b[this.name]=this.value||""}),b},a(".order_radio").on("change",function(){a(this).parents(".order_content").children(".order_comment").css("display","block")}),a(".order_comment_cancel").on("click",function(){var b=a(this).parents(".order_content").find(".order_content_form")[0]||null;a(this).parent().css("display","none"),b&&b.reset()}),a(".order_content .order_comment_save").on("click",function(){var c=document.createElement("p"),d=a(this).parents(".order_form"),e=a(this).parents(".order_content"),f=d.data("shop_id"),g=d.data("deal_id"),h=e.find(".text").val(),i=e.find(".order_content_form").serializeObject()["service-rate"];switch(i){case"1":c.innerHTML="已点评，不满意";break;case"2":c.innerHTML="已点评，一般般";break;default:c.innerHTML="已点评，满意"}a.ajax({url:b.commentRestaurant,type:"POST",data:{shop_id:f,deal_id:g,deal_satisfied:i,deal_satisfied_comment:h},success:function(a){"true"==a.success?(e.remove(),e.parent().append(c)):alert("评论失败，请重新评论!")}})}),a(".rating_comment .comment div").on("click",function(){var b=a(this).parents(".rating_comment");return b.find(".order_comment").css("display","block"),!1}).on("mouseover",star=function(){a(this).parents(".comment").find("div").removeClass("mouseover"),a(this).addClass("mouseover");var b=a(this).parents(".rating_comment").find(".rating_text");switch(this.innerText){case"1":b.html("差评");break;case"2":b.html("差点意思");break;case"3":b.html("一般般");break;case"4":b.html("有点滋味");break;default:b.html("我的最爱")}return!1}),a(".rating_comment .order_comment_save").on("click",function(){var c=a(this).parents(".rating_comment"),d=a(this).parents(".order_form"),e=d.data("shop_id"),f=d.data("deal_id"),g=c.data("goods_id"),h=c.find(".mouseover")[0].innerText[0],i=c.find(".text").val(),j=a(this);a.ajax({url:b.commentCate,type:"POST",data:{shop_id:e,deal_id:f,goods_id:g,goods_level:h,deal_satisfied_comment:i},success:function(a){"true"==a.success?(j.parents(".rating_comment").removeClass("rating_comment"),j.parents(".comment").find("div").off("mouseover",star)):alert("评论失败，请重新评论!")}})}),a(".col_btn").on("click",function(){var c=a(this),d=document.createElement("p"),e=c.parents(".content"),f=a(this).parents(".order_form"),g=f.data("shop_id"),h=f.data("deal_id"),i=e.find(".col_value span").html();d.innerHTML="已点评， 时间： "+i,a.ajax({url:b.commentSpeed,type:"POST",data:{shop_id:g,deal_id:h,deal_speed:i},success:function(a){"true"==a.success?(e.find(".content_speed").remove(),e.append(d)):alert("评论失败，请重新评论!")}})})});